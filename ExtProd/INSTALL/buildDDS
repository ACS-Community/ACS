#! /bin/bash
#*******************************************************************************
# E.S.O. - ALMA project
#
# "@(#) $Id: buildDDS,v 1.3 2008/08/14 08:38:18 bjeram Exp $"
#
# who       when        what
# --------  ----------  ----------------------------------------------
# bjeram    14/08/2008

# Load functions
. standardUtilities
#
# Fetch operating system and release version
#
os_discovery

LOG=buildDDS.log
exec > $LOG 2>&1

date

CURR_DIR=`pwd`

if [ "$OS" = "LINUX" ]
then 
  OSTAG=linux
else
  echo "OS $OS not supported"
  exit -1
fi

echo "Installing OpenDDS for $OSTAG"
echo 

if [ -d $ALMASW_ROOTDIR/$ALMASW_RELEASE/DDS ]
then
  echo $ALMASW_ROOTDIR/$ALMASW_RELEASE/DDS directory exists already. I clean it up.
  rm -rf $ALMASW_ROOTDIR/$ALMASW_RELEASE/DDS
fi
mkdir $ALMASW_ROOTDIR/$ALMASW_RELEASE/DDS


#
# Unpack the tar file
# put the sources under $ALMASW_ROOTDIR/$ALMASW_RELEASE/TAO
#
FILE=OpenDDS-1.1
ARCHIVE=`pwd`/../PRODUCTS/$FILE.tar.gz
cd $ALMASW_ROOTDIR/$ALMASW_RELEASE
echo "unpacking the archive"
gzip -cd $ARCHIVE | tar -xf - 
echo "done"
echo ""


cd DDS
make

cd $CURR_DIR
echo DDS installation done
date

