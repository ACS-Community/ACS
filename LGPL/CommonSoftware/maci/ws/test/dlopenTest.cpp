#include <iostream> 
#include <string>
#include <dlfcn.h>
#include <cstdlib>

using namespace std;

int main(int argc, char* argv[]) {
    if (argc <= 1) {
        exit(0);
    }
    string filename = argv[1];
    cerr << "file = " << filename << endl;
    void* mylib = dlopen(filename.c_str(), RTLD_GLOBAL|RTLD_LAZY);
    if (mylib==NULL)
    {
    	cerr << "Problem opening library: " << filename << " Reason: " << dlerror() << endl;
    	return -1;
    }

    cerr << "Calling dlclose " << endl;
    int eret = dlclose(mylib);
    cerr << dlerror() << endl;
    cerr << "eret = " << eret << endl;
}
