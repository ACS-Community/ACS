#!/bin/bash
#--------------------------------------------------

# A helpful message describing how this command works
function printUsage
{
	echo "Usage: `basename $0` [OPTIONS] type_of_container name_of_container"
	echo "Wait for the named container to start."
	echo ""
	echo "Options:"
	echo "-h, --help      Prints this message and exits"
	
}

if [ "$1" = "-h" -o "$1" = "--help" ] ; then
    printUsage;
    exit 0;
fi

if [ "$#" -ne "2" ] ; then
	echo "Error: wrong number of parameters provided"
    printUsage;
    exit 1;
fi

# Now the actual work gets done
#first need to figure out $ACS_TMP
if [ "$ACS_TMP" = "" ]
then 
    export ACS_TMP=$ACSDATA/tmp
fi

#replace /'s with _'s in the container name
FILE=`echo "$2.out" | sed 's/\//_/g'`

#params that go to acsutilBlock
EXTRA_PARAMS=

#if this is being used from tat, make sure acsutilTATTestRunner is used
if [ -e $ACS_TMP/acs_instance ]
then
    EXTRA_PARAMS="$EXTRA_PARAMS -x"
fi

#Just delgate to helper script
acsutilBlock -f $ACS_TMP/$FILE -b "ContainerStatusMsg: Ready" $EXTRA_PARAMS acsStartContainer $@
